var DEVTEST=!1;function renderHtmlTemplate(t,r){var e=["Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen","Twenty"];templateData={depId:CC_LITE_SESSION_DATA.depId,getReportFileServiceUrl:CC_LITE_SESSION_DATA.servicePathPrefix+ChemCompLiteMod.URL.GET_REPORT_FILE,ligands:[]},rKeys=Object.keys(t),tabStyle="_current";for(var i=0;i<rKeys.length;i++){if(1<i+1&&(tabStyle="displaynone"),ligGroupData=t[rKeys[i]],ligandEntry={index:i+1,tabStyle:tabStyle,ligGroup:rKeys[i],dynamicText:{},data:ligGroupData},ligGroupData.bGrpRequiresAttention){var s=1<ligGroupData.totlInstncsInGrp?"there is at least one instance for which ":"",a=1<ligGroupData.totlInstncsInGrp?"sections below for those instances that require ":"section below for the instance that requires ";ligandEntry.dynamicText.mismatchMessage="<br /><br />However, "+s+"there is a discrepancy between the coordinates for "+rKeys[i]+" and the possible match in the CCD. Please see "+a+'attention. Clicking on section headers labelled "instance" will expand/collapse content. Both 2D and 3D comparison views are provided.<br /><br />The section "address mismatched instances of: '+rKeys[i]+'" allows you to provide more information about this ligand. Please provide at least one of the following: an alternative ligand ID, a chemical diagram by file upload of image file or a descriptor string in SMILES/InChI format. When you have finished with this ligand, press the "Save" button at the bottom of the page.'}else ligandEntry.dynamicText.mismatchMessage="";ligandEntry.dynamicText.have=1<ligGroupData.totlInstncsInGrp?"have":"has",ligandEntry.dynamicText.copy=1<ligGroupData.totlInstncsInGrp?"copies":"copy",ligandEntry.dynamicText.totalText=21<ligGroupData.totlInstncsInGrp?ligGroupData.totlInstncsInGrp:e[ligGroupData.totlInstncsInGrp],ligandEntry.data.bGrpRequiresAttention=ligandEntry.data.bGrpRequiresAttention?"attn_reqd":"",ligandEntry.data.bGrpRequiresAttentionDisplay=ligandEntry.data.bGrpRequiresAttention?"":"displaynone",ligandEntry.data.isResolvedClass=ligandEntry.data.isResolved?"is_rslvd":"not_rslvd","attn_reqd"===ligandEntry.data.bGrpRequiresAttention?ligandEntry.mismatchUrl=CC_LITE_SESSION_DATA.servicePathPrefix+ChemCompLiteMod.URL.GET_REPORT_FILE+"?identifier="+CC_LITE_SESSION_DATA.depId+"&source=report&ligid="+ligandEntry.ligGroup+"&file="+ligandEntry.ligGroup+"_mismatch.html":ligandEntry.mismatchUrl=null,templateData.ligands.push(ligandEntry)}return fetch("/ccmodule_lite/templates/workflow_ui/instances_view/cc_instance_browser_template.html").then(function(t){return t.text()}).then(function(t){var e=Mustache.render(t,templateData);document.getElementById(r).innerHTML=e})}function applyBeautyTips(){jQuery.bt.options.cssStyles={font:"12px sans-serif",fontFamily:"Verdana,Arial,sans-serif"},$(".save_descr").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#save_btn",ajaxOpts:{dataType:"html"},trigger:"hover",width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",strokeStyle:"#ABABAB",strokeWidth:1}),$(".save_rsrch_data").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#save_rsrch_btn",ajaxOpts:{dataType:"html"},trigger:"hover",width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",strokeStyle:"#ABABAB",strokeWidth:1}),$(".save_exact_mtch_id").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#save_btn",ajaxOpts:{dataType:"html"},trigger:"hover",width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",strokeStyle:"#ABABAB",strokeWidth:1}),$("div.savedone").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#finish",ajaxOpts:{dataType:"html"},trigger:"hover",width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",strokeStyle:"#ABABAB",strokeWidth:1}),$(".instance_browser_ui").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#instnc_srch_scrn",ajaxOpts:{dataType:"html"},trigger:"hover",width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",strokeStyle:"#ABABAB",strokeWidth:1}),$(".back_to_summary_vw").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#lgnd_summry_scrn",ajaxOpts:{dataType:"html"},trigger:"hover",width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",strokeStyle:"#ABABAB",strokeWidth:1}),$("span.tophit").bt({positions:["bottom","left","top"],contentSelector:"$('#twoD_'+$(this).text()+'')",trigger:"hover",centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",strokeStyle:"#ABABAB",strokeWidth:1}),$("span.author_assgnd_id").bt({positions:["bottom","left","top"],contentSelector:"$('#'+$(this).text()+'_2d_auth_assgnd')",trigger:"hover",centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",strokeStyle:"#ABABAB",strokeWidth:1,ajaxError:"There was a problem getting this content. Ligand ID may be invalid."}),$("textarea.capture_rsrch_data_input.target_seq").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#binding_target_seq",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$("select.capture_rsrch_data_input.dscrptr_type").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_dscrptr_str",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$("input.capture_rsrch_data_input.rsrch_dscrptr_str").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_dscrptr_str",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$("input.capture_rsrch_data_input.ph").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_ph",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$("input.capture_rsrch_data_input.temp").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_temp",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$("select.capture_rsrch_data_input.measurement_type").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_measurement_type",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$("input.capture_rsrch_data_input.measured_value").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_measured_value",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$("textarea.capture_rsrch_data_input.details").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_details",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$(".target_sequence_lbl").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#binding_target_seq",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$(".rsrch_dscrptr_type_lbl").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_dscrptr_str",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$(".ph_lbl").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_ph",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$(".assay_temp_lbl").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_temp",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$(".measurement_type_lbl").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_measurement_type",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$(".measured_value_lbl").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_measured_value",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$(".details_lbl").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_details",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1}),$(".head.rsrch_data").bt({positions:["bottom","left","top"],ajaxPath:CC_LITE_SESSION_DATA.servicePathPrefix+"/ccmodule_lite/cc_help.html div#rsrch_hdr",ajaxOpts:{dataType:"html"},width:600,centerPointX:.9,spikeLength:20,spikeGirth:10,padding:15,cornerRadius:25,fill:"#FFF",trigger:"hoverIntent",hoverIntentOpts:{interval:150},strokeStyle:"#ABABAB",strokeWidth:1})}function closeWindow(){"Microsoft Internet Explorer"==navigator.appName?(this.focus(),self.opener=this,self.close()):(window.open("","_parent",""),window.close())}function unresolvedGrpsHandler(){var e=0;return $("#rslts td.resolve_status").each(function(){var t=$(this).html();"Mismatch(es) Require Attention"==t?(e+=1,$(this).removeClass("beenrslved")):"OK"!=t&&$(this).addClass("beenrslved")}),e}function getBrowserType(){$.browser.firefox=/firefox/.test(navigator.userAgent.toLowerCase()),$.browser.chrome=/chrom(e|ium)/.test(navigator.userAgent.toLowerCase()),$.browser.msie=/trident/.test(navigator.userAgent.toLowerCase()),$.browser.chrome&&(ChemCompLiteMod.currBrowser="chrome"),$.browser.firefox&&(ChemCompLiteMod.currBrowser="firefox"),$.browser.msie&&(ChemCompLiteMod.currBrowser="msie")}function getLigSummaryRslts(){return $(ChemCompLiteMod.loadSmmryFrmLctr).ajaxSubmit({url:ChemCompLiteMod.URL.GEN_LIG_SMMRY_RSLTS,async:!0,clearForm:!1,success:function(t){checkSummaryStatus(t,ChemCompLiteMod.URL.CHECK_FOR_SMMRY_DATA)}}),!1}function checkSummaryStatus(t,e){try{ChemCompLiteMod.dataAvail="no";var r=setInterval(function(){checkForRsltsData(t,e,3),"yes"==ChemCompLiteMod.dataAvail&&(clearInterval(r),$(ChemCompLiteMod.loadSmmryFrmLctr).ajaxSubmit({url:ChemCompLiteMod.URL.LOAD_LIG_SMMRY_DATA,async:!0,clearForm:!1,target:"#rslts",success:function(){$(".savedone").removeAttr("disabled"),applyBeautyTips(),unresolvedGrpsHandler(),updateSummarySelect(),$(".instance_browser_ui").removeAttr("disabled")},error:function(){$(".errmsg").html(errStyle+"Failed to load ligand summary data.<br />\n"+ChemCompLiteMod.adminContact).show()}}))},3e3)}catch(t){$(".errmsg").html(errStyle+"Error on checking for ligand summary data.<br />\n"+ChemCompLiteMod.adminContact).show().delay(5e3).slideUp(800)}}function loadSummaryData(){$(ChemCompLiteMod.loadSmmryFrmLctr).ajaxSubmit({url:ChemCompLiteMod.URL.LOAD_LIG_SMMRY_DATA,async:!0,clearForm:!1,target:"#rslts",success:function(){$(".savedone").removeAttr("disabled"),applyBeautyTips(),unresolvedGrpsHandler(),updateSummarySelect(),$(".instance_browser_ui").removeAttr("disabled")},error:function(){$(".errmsg").html(errStyle+"Failed to load ligand summary data.<br />\n"+ChemCompLiteMod.adminContact).show()}})}function updateSummarySelect(){0<$(".selectinstnc_td :checked").length?($(".selectinstnc_td").css("backgroundColor",""),0<$(".c_NONE_special .selectinstnc_td :checked").length?($("#ligand_inventory_tbl .selectinstnc_td .selectinst_stdgrp").attr("disabled","disabled"),$("#ligand_inventory_tbl .selectinstnc_td .selectinst_none").removeAttr("disabled")):($("#ligand_inventory_tbl .selectinstnc_td .selectinst_stdgrp").removeAttr("disabled"),protectRsrchDataHandler(),$("#ligand_inventory_tbl .selectinstnc_td .selectinst_none").attr("disabled","disabled"))):($(".selectinstnc_td").css("backgroundColor","#FFE6E6"),$("#ligand_inventory_tbl .selectinstnc_td .selectinst_stdgrp").removeAttr("disabled"),protectRsrchDataHandler(),$("#ligand_inventory_tbl .selectinstnc_td .selectinst_none").removeAttr("disabled"))}function checkForRsltsData(t,e,r){var i;return $.ajax({type:"GET",url:e,async:!0,cache:!1,data:{semaphore:t.semaphore,sessionid:CC_LITE_SESSION_DATA.sessionID,delay:r},success:function(t){"completed"==(i=t.statuscode)&&(ChemCompLiteMod.dataAvail="yes")},error:function(t){alert("error on call to check for results data")}}),i}function checkMissingLigandTypeField(t){var e=!1;return $("#lgnd_type_"+t+" input[name='lgnd_type']:checked").val()||(e=!0),e?$("#fieldset_lgnd_type_"+t).css({"border-color":"#CD0A0A","background-color":"#FEF1EC","border-style":"solid","border-width":"1px"}):$("#fieldset_lgnd_type_"+t).css({"border-color":"#f6f6f5","background-color":"#FFF","border-style":"groove","border-width":"2px"}),e}function loadInstanceBrowserView(){ChemCompLiteMod.activeCCid=1,$("#ligand_summary_vw").hide(),$("#help_batch_smmry_vw").hide();var t=$("#mismatchlist").html();ChemCompLiteMod.ligIdsMismatched=t.split(",");var e=$("#rslvdlist").html();e&&(ChemCompLiteMod.ligIdsRslvd=e.split(","));var r=$("#ligids").val(),i=$("#ligids_inst_vw").val(),s=$("#ligids_rsrch").val(),a=$("#ligids_rsrch_inst_vw").val();if($("#instnc_browser_container").html().length<=150||i!=r||a!=s)return $("#instnc_browser_container").html('<div class="loading_msg">&nbsp;&nbsp;<img src="/images/loading.gif" alt="loading..." />&nbsp;&nbsp;Data being processed.</div>'),$("#instnc_brwser_vw").show(),$("#ligids_inst_vw").val(r),$("#ligids_rsrch_inst_vw").val(s),$("#inst_brwsr_frm").ajaxSubmit({url:CC_LITE_SESSION_DATA.servicePathPrefix+ChemCompLiteMod.URL.GET_LIGAND_SUMMARY,async:!0,clearForm:!1,beforeSubmit:function(t,e,r){t.push({name:"browser",value:ChemCompLiteMod.currBrowser})},target:"#instnc_browser_container",success:function(t){renderHtmlTemplate(t,"instnc_browser_container").then(function(){$("#pagi").paginate({count:$(".tabscount").size(),start:ChemCompLiteMod.activeCCid,display:6,border:!0,border_color:"#BEF8B8",text_color:"#68BA64",background_color:"#E3F2E1",border_hover_color:"#68BA64",text_hover_color:"black",background_hover_color:"#CAE6C6",images:!1,mouse:"press",onChange:function(t){$("._current").removeClass("_current").slideUp("slow"),$("#p"+t).addClass("_current").slideDown("slow"),$("#p_"+t).addClass("_current").slideDown("slow"),$("#p__"+t).addClass("_current").slideDown("slow"),ChemCompLiteMod.activeCCid=t}}),$(".single_instance").hide();$(".cmpnt_grp:first").html();$(".inneraccordion").each(function(t){$(this).find(".single_instance:first").show(),$(this).find("span.ui-icon:first").toggleClass("ui-icon-circle-arrow-s ui-icon-circle-arrow-e")}),$(".inneraccordion div.all_instances").each(function(t){$(this).show(),$(this).parent().find("a.all_instances span.ui-icon").toggleClass("ui-icon-circle-arrow-s ui-icon-circle-arrow-e");var e=$(this).attr("name");checkMissingLigandTypeField(e),checkForUploadedImageFiles(e,"requirementscheck"),checkCompDefFileUploads(e,"refresh")}),$("#restart").click(function(){alert("[PLACEHOLDER] -- will perform restart action")}),$(".savedone").removeAttr("disabled"),$(".instance_browser_ui").removeAttr("disabled"),$(".back_to_summary_vw").removeAttr("disabled"),$(".back_to_summary_vw").show(),$(".instance_browser_ui").hide(),$(document).on("click",".back_to_summary_vw",function(){window.parent.$("div.ui-layout-center.ui-layout-pane.ui-layout-pane-center").animate({scrollTop:0},"slow"),$(".back_to_summary_vw").hide(),$(".instance_browser_ui").show(),$("#instnc_brwser_vw").hide(),$("#help_instnc_brwser_vw").hide(),unresolvedGrpsHandler(),$("#ligand_summary_vw").show(),$("#help_batch_smmry_vw").show(),protectRsrchDataHandler()}),applyBeautyTips(),disableCopyRsrchDscrptr()})}}),$("ul.jPag-pages li").each(function(t){var e=$(this).text();0<=ChemCompLiteMod.ligIdsMismatched.indexOf(e)&&$(this).addClass("attn_reqd"),ChemCompLiteMod.ligIdsRslvd&&0<=ChemCompLiteMod.ligIdsRslvd.indexOf(e)&&($(this).addClass("is_rslvd"),$(this).removeClass("attn_reqd"))}),!1;$("#instnc_brwser_vw").show(),$(".back_to_summary_vw").show(),$(".instance_browser_ui").hide()}function disableCopyRsrchDscrptr(){$(".copy_rsrch_dscrptr_str").each(function(t){var e=$(this).attr("id").split("_")[5];ChemCompLiteMod.ligIdsMismatched&&ChemCompLiteMod.ligIdsMismatched.indexOf(e)<0&&ChemCompLiteMod.ligIdsRslvd&&ChemCompLiteMod.ligIdsRslvd.indexOf(e)<0&&$(this).attr("disabled","disabled")})}function protectRsrchDataHandler(){for(var t=0;t<ChemCompLiteMod.ligIdsWithRsrchSubmitted.length;t++){var e=ChemCompLiteMod.ligIdsWithRsrchSubmitted[t];$("#"+e+"_rsrch").attr("disabled","disabled")}for(t=0;t<ChemCompLiteMod.ligIdsMissingRsrch.length;t++){e=ChemCompLiteMod.ligIdsMissingRsrch[t];$("#"+e+"_rsrch").removeAttr("disabled")}}function disableRsrchDataCntrls(t,e){$(".capture_rsrch_data_input.c_"+t).each(function(){$(this).attr("disabled","disabled")}),revertColorRsrchDataSaveBtn(t)}function enableRsrchDataCntrls(t,e){$(".capture_rsrch_data_input.c_"+t).each(function(){$(this).removeAttr("disabled")}),disableCopyRsrchDscrptr()}function checkForValidInput(t,e,r){var i=!1;return t&&0<t.length&&(i=t.trim().match(ChemCompLiteMod.inputTypeValidation[e])),i||"notify"!==r||alert("Invalid "+ChemCompLiteMod.inputTypeValidation.displaytext[e]+" entered. Please correct."),i}function enableRsrchDataSaveBtn(t){$(".capture_rsrch_data_submit_"+t).removeAttr("disabled"),highlightColorRsrchDataSaveBtn(t)}function revertColorRsrchDataSaveBtn(t){$(".capture_rsrch_data_submit_"+t).css("color","")}function highlightColorRsrchDataSaveBtn(t){$(".capture_rsrch_data_submit_"+t).css("color","red")}function getAnalysisState(){return fetch(ChemCompLiteMod.URL.GET_REPORT_STATUS+"?sessionid="+CC_LITE_SESSION_DATA.sessionID+"&identifier="+CC_LITE_SESSION_DATA.depId+"&instance=&filesource=deposit").then(function(t){return t.json()}).then(function(t){switch(t.state){case"running":$(".loading_msg").get(0).innerText="Analysis still in progress... "+Number.parseFloat(100*t.progress).toFixed(2)+"% complete.";break;case"finished":clearInterval(window.stateHandle),loadSummaryData();break;case"missing_file":$(".loading_msg").get(0).innerText="Running pre-analysis operations. This may take a while.";break;case"stopped":case"unknown":clearInterval(window.stateHandle),$(".loading_msg").get(0).innerHtml="Something went wrong. Please, run the analysis again."}return t})}function updateResearchList(t,i){$("#hlprfrm_auth_assgnd_grp").val(t),$("#hlprfrm").ajaxSubmit({url:ChemCompLiteMod.URL.UPDATE_RSRCHLST,clearForm:!1,beforeSubmit:function(t,e,r){t.push({name:"mode",value:i})},success:function(){$("#hlprfrm_auth_assgnd_grp").val("")}})}Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){for(var r=e||0,i=this.length;r<i;r++)if(this[r]===t)return r;return-1}),String.prototype.replaceAll||(String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t,"g"),e)}),$(document).on("lazybeforeunveil",function(t){var e,r=$(t.target);r&&("mismatch_section"!==r.attr("id")?r.hasClass("single_instance")?(e=r.data("ajax"))&&r.load(e):(r.next().show("slow"),r.find("span.ui-icon").toggleClass("ui-icon-circle-arrow-s ui-icon-circle-arrow-e")):(e=r.data("ajax"))&&r.load(e))}),getAnalysisState().then(function(t){"running"==t.state&&(window.stateHandle=setInterval(getAnalysisState,3e3))}),$(document).on("click","input.savedone",function(){var s=0;if("deposit"==CC_LITE_SESSION_DATA.fileSource.toLowerCase())$("#hlprfrm").ajaxSubmit({url:ChemCompLiteMod.URL.EXIT_FINISHED,clearForm:!1,beforeSubmit:function(t,e,r){s=unresolvedGrpsHandler();var i=0<$(".selectinstnc_td :checked").length;return 0<s?(alert("Ligand processing cannot be completed because one or more ligands require attention. Please address any outstanding mismatches."),!1):i?void t.push({name:"sessionid",value:CC_LITE_SESSION_DATA.sessionID}):($(".instance_browser_ui").is(":visible")?alert("Ligand processing cannot be completed as 'Focus of Research' has not been specified from this page."):alert("Ligand processing cannot be completed as 'Focus of Research' has not been specified from summary page. Please press the 'Back to Summary View' button to return to summary page to correct this."),!1)},success:function(){alert("Work will be saved and ligand processing now complete."),DEVTEST?$("html").html('TESTING: you can inspect result files/uploads <a href="'+CC_LITE_SESSION_DATA.servicePathPrefix+"/sessions/"+CC_LITE_SESSION_DATA.sessionID+'/results.html">here</a>'):(closeWindow(),$("html").html(""))}});else{if(0<(s=unresolvedGrpsHandler()))return alert("Ligand processing cannot be completed because one or more ligands require attention. Please address any outstanding mismatches."),!1;alert("Save (Done)"),checkval=0,closeWindow(),$("html").html("")}}),$(document).on("click",".instance_browser_ui",function(){var t,e,r="",i="";$("#ligand_summary_vw :checkbox:checked:not(#selectall):not(.selectinstnc_rsrch):not(#selectall_rsrch)").each(function(){t=$(this).attr("name"),r+=(0<r.length?",":"")+t,ChemCompLiteMod.ligIdsSlctdForInstcVw.indexOf(t)<0&&ChemCompLiteMod.ligIdsSlctdForInstcVw.push(t)}),$("#ligand_summary_vw :checkbox:checked:not(#selectall):not(.selectinstnc):not(#selectall_rsrch)").each(function(){e=$(this).attr("name").split("_")[0],i+=(0<i.length?",":"")+e}),$("#ligids").val(r),$("#ligids_rsrch").val(i),0<ChemCompLiteMod.ligIdsSlctdForInstcVw.length?($("#help_instnc_brwser_vw").show(),document.title=CC_LITE_SESSION_DATA.depId+" : Instance Browser View",loadInstanceBrowserView()):alert("Please select at least one entry to submit to Instance Browser View.")}),window.onbeforeunload=function(t){0},$(document).on("click","#selectall",function(){$(this).parents("div:eq(0)").find(".selectinstnc").prop("checked",this.checked),this.checked||(ChemCompLiteMod.ligIdsSlctdForInstcVw.length=0)}),$(document).on("click",".selectinstnc",function(){var t=$(this).attr("name");if(!this.checked){$("#selectall").prop("checked",this.checked);var e=ChemCompLiteMod.ligIdsSlctdForInstcVw.indexOf(t);0<=e&&ChemCompLiteMod.ligIdsSlctdForInstcVw.splice(e,1)}}),$(document).on("click","#selectall_rsrch",function(){var t=this.checked,e="";t?($(this).parents("div:eq(0)").find(".selectinstnc_rsrch").prop("checked",this.checked),$("#ligand_summary_vw :checkbox:checked:not(#selectall):not(.selectinstnc):not(#selectall_rsrch)").each(function(t){thisLigIdRsrch=$(this).attr("name").split("_")[0],e+=(0<t?",":"")+thisLigIdRsrch}),updateResearchList(e,"add")):($(this).parents("div:eq(0)").find(".selectinstnc_rsrch:enabled").prop("checked",this.checked),$("#ligand_summary_vw :checkbox:not(:checked):not(#selectall):not(.selectinstnc):not(#selectall_rsrch)").each(function(t){thisLigIdRsrch=$(this).attr("name").split("_")[0],e+=(0<t?",":"")+thisLigIdRsrch}),updateResearchList(e,"remove")),updateSummarySelect()}),$(document).on("click",".selectinstnc_rsrch",function(){var t=$(this).attr("name").split("_")[0];this.checked?updateResearchList(t,"add"):($("#selectall_rsrch").attr("checked",this.checked),updateResearchList(t,"remove")),updateSummarySelect()}),$(document).on("click",".addanother_rsrch",function(t){var e=$(this).attr("id").split("_"),r=e[3],i=e[2],s="#rsrch_data_set_"+i+"_"+parseInt(r)+"_",a=$(s).clone().html().replaceAll("_"+parseInt(r)+"_","_"+(parseInt(r)+1)+"_");a=(a="HOH"==i?a.replaceAll("Site - "+(parseInt(r)+1),"Site - "+(parseInt(r)+2)):a.replaceAll("Assay Data - "+(parseInt(r)+1),"Assay Data - "+(parseInt(r)+2))).replaceAll("displaynone","");var n="rsrch_data_set_"+i+"_"+(parseInt(r)+1)+"_";$(s).after('<div id="'+n+'" class="rsrch_data_set" >'),$("#"+n).append(a),$("#"+n+' input:not([type="button"])').val(""),$("#"+n+" select").val(""),$("#"+n+" textarea").val(""),$("#"+n+" .disabled_2").attr("disabled","disabled"),$("#"+n+" .disabled_3").attr("disabled","disabled"),$("#"+n+" .disabled_4").attr("disabled","disabled"),$("#binding_dataset_actions_"+i+"_"+parseInt(r)+"_").hide(),3==parseInt(r)&&$("#addanother_rsrch_"+i+"_"+(parseInt(r)+1)+"_").hide(),applyBeautyTips()}),$(document).on("click",".deletethis_rsrch",function(t){var e=$(this).attr("id").split("_"),r=e[3],i=e[2],s="#rsrch_data_set_"+i+"_"+parseInt(r)+"_";$(s).remove(),$("#binding_dataset_actions_"+i+"_"+(parseInt(r)-1)+"_").show(),1<r&&$("#deletethis_rsrch_"+i+"_"+(parseInt(r)-1)+"_").show()}),$(document).on("click",".copy_rsrch_dscrptr_str",function(t){var e=$(this).attr("id").split("_"),r=e[6],i=e[5],s=!0,a=$("#dscrptr_type_"+i).val(),n=$("#dscrptr_str_"+i).val().trim();if(0==n.length&&(alert("Descriptor string not provided in Ligand Verification section."),s=!1),s){var o="#rsrch_dscrptr_type_"+i+"_"+parseInt(r)+"_",c="#rsrch_dscrptr_str_"+i+"_"+parseInt(r)+"_";$(o).val(a),$(c).val(n),$(c).removeAttr("disabled")}}),$(document).on("change",".capture_rsrch_data_input.assay_type",function(t){var e=$(this).val().trim(),r=$(this).attr("id"),i=r.split("_"),s=i[i.length-3],a=i[i.length-2];r.split("_"+s+"_"+a+"_")[0];e&&0<e.length&&$("#rsrch_data_set_"+s+"_"+a+"_ .disabled_2").removeAttr("disabled")}),$(document).on("change",".capture_rsrch_data_input.dscrptr_type",function(t){var e=$(this).val().trim(),r=$(this).attr("id"),i=r.split("_"),s=i[i.length-3],a=i[i.length-2];r.split("_"+s+"_"+a+"_")[0];if(e&&1<e.length){$("#rsrch_dscrptr_str_"+s+"_"+a+"_").removeAttr("disabled"),$("#"+r+" option:eq(0)").attr("disabled","disabled");var n=$("#rsrch_dscrptr_str_"+s+"_"+a+"_").val().trim();if(n&&0<n.length)checkForValidInput(n,e,"notify")}}),$(document).on("change",".capture_rsrch_data_input.measurement_type",function(t){var e=$(this).val().trim(),r=$(this).attr("id"),i=r.split("_"),s=i[i.length-3],a=i[i.length-2];r.split("_"+s+"_"+a+"_")[0];if(e&&1<e.length){$("#measured_value_"+s+"_"+a+"_").removeAttr("disabled"),$("#"+r+" option:eq(0)").attr("disabled","disabled");var n=$("#measured_value_"+s+"_"+a+"_").val().trim();if(n&&0<n.length)checkForValidInput(n,"measured_value","notify")}}),$(document).on("keyup",".capture_rsrch_data_input.measured_value",function(t){var e=$(this).val().trim(),r=$(this).attr("id"),i=r.split("_"),s=i[i.length-3],a=i[i.length-2];r.split("_"+s+"_"+a+"_")[0];e&&0<e.length&&($("#rsrch_data_set_"+s+"_"+a+"_ .disabled_3").removeAttr("disabled"),disableCopyRsrchDscrptr())}),$(document).on("blur",'.capture_rsrch_data_input:not(.rsrch_dscrptr_str):not([type="button"])',function(t){var e=$(this).val().trim(),r=$(this).attr("id"),i=r.split("_"),s=i[i.length-3],a=i[i.length-2],n=r.split("_"+s+"_"+a+"_")[0];e&&0<e.length?checkForValidInput(e,n,"notify")&&enableRsrchDataSaveBtn(s):"measured_value"==n&&$("#measurement_type_"+s+"_"+a+"_ option:eq(0)").removeAttr("disabled")}),$(document).on("blur",".capture_rsrch_data_input.rsrch_dscrptr_str",function(t){var e=$(this).val().trim(),r=$(this).attr("id").split("_"),i=r[3],s=r[4],a=$("#rsrch_dscrptr_type_"+i+"_"+s+"_").val();e&&0<e.length?checkForValidInput(e,a,"notify")&&enableRsrchDataSaveBtn(i):$("#rsrch_dscrptr_type_"+i+"_"+s+"_ option:eq(0)").removeAttr("disabled")}),$(document).on("click",".save_rsrch_data",function(){var t=$(this).attr("value"),n=($(this),$(this).attr("name")),e="span.datasubmitted_status."+n,r="span.no_datasubmitted_status."+n,i="#capture_rsrch_data_frm_"+n;if(0<=t.indexOf("Save")){var s=!0,a="HOH"!=n?':not([type="button"])':'[type="text"]',o=new Object;for(index in $(".c_"+n+".capture_rsrch_data_input"+a).each(function(t){var e=$(this).val(),r=$(this).attr("id"),i=r.split("_"),s=i[i.length-2],a=r.split("_"+n+"_"+s+"_")[0];o.hasOwnProperty(s)||(o[s]=new Object,o[s].notEmpty=!1,o[s].validData=!0,"HOH"!=n&&(o[s].countOfEmptyMeasurementGrpItems=0,o[s].dscrptrMissing=!1,o[s].dscrptrTypeMissing=!1,o[s].haveAssayType=!0)),e&&1<=e.trim().length&&e!==n?o[s].notEmpty=!0:"assay_type"==a&&(o[s].haveAssayType=!1)}),"HOH"!=n&&$(".c_"+n+".capture_rsrch_data_input.measurement_grp").each(function(t){var e=$(this).val(),r=$(this).attr("id").split("_"),i=r[r.length-2];e&&1<=e.length||(o[i].countOfEmptyMeasurementGrpItems+=1)}),$(".c_"+n+'.capture_rsrch_data_input:not(.rsrch_dscrptr_str):not([type="button"]):not(select)').each(function(t){var e=$(this).val(),r=$(this).attr("id"),i=r.split("_"),s=i[i.length-3],a=i[i.length-2],n=r.split("_"+s+"_"+a+"_")[0];e&&0<e.trim().length&&(checkForValidInput(e,n,"onglobalsave")||(o[a].validData=!1))}),$(".c_"+n+".capture_rsrch_data_input.rsrch_dscrptr_str").each(function(t){var e=$(this).val().trim(),r=$(this).attr("id").split("_"),i=r[3],s=r[4],a=$("#rsrch_dscrptr_type_"+i+"_"+s+"_").val();e&&0<e.length?a?checkForValidInput(e,a,"onglobalsave")||(o[s].validData=!1):o[s].dscrptrTypeMissing=!0:a&&0<a.length&&(o[s].dscrptrMissing=!0)}),o)o[index].notEmpty?"HOH"==n||o[index].haveAssayType||(s=!1,alert("Cannot submit dataset without specifying the assay type. Please check content in dataset #"+(parseInt(index)+1))):(s=!1,alert("Cannot submit an empty dataset. Please check content in dataset #"+(parseInt(index)+1))),s&&(o[index].validData||(s=!1,alert("Still have input that requires correction. Please check dataset #"+(parseInt(index)+1)))),s&&"HOH"!=n&&(0<o[index].countOfEmptyMeasurementGrpItems&&(s=!1,alert("Measurement type and measured value must both be provided. Please check dataset #"+(parseInt(index)+1))),o[index].dscrptrMissing&&(s=!1,alert("Descriptor type is specified but corresponding string is missing. Please check dataset #"+(parseInt(index)+1))),o[index].dscrptrTypeMissing&&(s=!1,alert("Descriptor string is provided but corresponding descriptor type is missing. Please check dataset #"+(parseInt(index)+1))));!1,s&&($("#rsrch_mode_"+n).val("done"),"HOH"!=n?($("#"+n+"_capture_rsrch_data .save_rsrch_data").val("Edit Ligand Binding Data"),$(e).show(),$(r).hide()):$("#"+n+"_capture_rsrch_data .save_rsrch_data").val("Edit"),$(i).ajaxSubmit({url:ChemCompLiteMod.URL.SAVE_RSRCH_DATA,async:!0,clearForm:!1,success:function(){disableRsrchDataCntrls(n,"done"),applyRsrchAcqdStatusHighlight(n),ChemCompLiteMod.ligIdsWithRsrchSubmitted.push(n);var t=ChemCompLiteMod.ligIdsMissingRsrch.indexOf(n);0<=t&&ChemCompLiteMod.ligIdsMissingRsrch.splice(t,1),protectRsrchDataHandler()}}))}else $("#rsrch_mode_"+n).val("undo"),$(e).hide(),$(r).show(),"HOH"!=n?$("#"+n+"_capture_rsrch_data .save_rsrch_data").val("Save Ligand Binding Data"):$("#"+n+"_capture_rsrch_data .save_rsrch_data").val("Save"),$(i).ajaxSubmit({url:ChemCompLiteMod.URL.SAVE_RSRCH_DATA,async:!0,clearForm:!1,success:function(){enableRsrchDataCntrls(n,"undo"),applyRsrchAcqdStatusHighlight(n),highlightColorRsrchDataSaveBtn(n),ChemCompLiteMod.ligIdsMissingRsrch.push(n);var t=ChemCompLiteMod.ligIdsWithRsrchSubmitted.indexOf(n);0<=t&&ChemCompLiteMod.ligIdsWithRsrchSubmitted.splice(t,1),protectRsrchDataHandler()}})});